<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Vocab Learner</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- Firebase compat SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore-compat.js"></script>
  </head>
  <body>
    <!-- Screen: Auth -->
    <div id="authScreen" class="screen auth-screen">
      <h1>Vocab Learner</h1>
      <p>ƒêƒÉng nh·∫≠p ƒë·ªÉ b·∫Øt ƒë·∫ßu h·ªçc</p>
      <button id="btn-login" class="primary">ƒêƒÉng nh·∫≠p v·ªõi Google</button>
    </div>

    <!-- Screen: Topic selector -->
    <div id="topicScreen" class="screen hidden">
      <header class="topbar">
        <h1>Ch·ªçn ch·ªß ƒë·ªÅ</h1>
        <div style="display: flex; gap: 8px; align-items: center">
          <button id="btn-manage-topics" class="secondary">‚ûï Ch·ªß ƒë·ªÅ</button>
          <button id="btn-logout" class="link">ƒêƒÉng xu·∫•t</button>
        </div>
      </header>

      <main class="topics" id="topicList">
        <!-- Fallback: JS s·∫Ω render l·∫°i ƒë·∫ßy ƒë·ªß; gi·ªØ v√†i n√∫t m·∫∑c ƒë·ªãnh cho l·∫ßn t·∫£i ƒë·∫ßu -->
        <button class="topic-btn" data-topic="food">üçî Food &amp; Drink</button>
        <button class="topic-btn" data-topic="family">üë®‚Äçüë©‚Äçüëß Family</button>
        <button class="topic-btn" data-topic="travel">‚úàÔ∏è Travel</button>
        <button class="topic-btn" data-topic="school">üè´ School</button>
        <button class="topic-btn" data-topic="work">üíº Work</button>
        <button class="topic-btn" data-topic="daily">üåû Daily Life</button>
      </main>
    </div>

    <!-- Screen: Study -->
    <div id="studyScreen" class="screen hidden">
      <header class="topbar">
        <div class="left">
          <button id="btn-back" class="link">‚¨Ö Ch·ªß ƒë·ªÅ</button>
          <h1 id="topicTitle">Food &amp; Drink</h1>
        </div>
        <div class="right">
          <button id="btn-quiz" class="primary">Quiz(c√¢u h·ªèi)</button>
          <button id="btn-addWord" class="secondary">‚ûï Th√™m t·ª´</button>
          <button id="btn-edit" class="secondary">‚úé S·ª≠a th·∫ª</button>
          <button id="btn-delete" class="danger hidden">üóëÔ∏è Xo√° th·∫ª</button>
          <button id="btn-settings" class="secondary" title="C√†i ƒë·∫∑t TTS">
            ‚öôÔ∏è
          </button>
        </div>
      </header>

      <main>
        <section class="status">
          <div>Ch·ªß ƒë·ªÅ: <strong id="topicName">Food &amp; Drink</strong></div>
          <div>
            ƒê√£ h·ªçc: <strong id="learnedCount">0</strong> /
            <span id="totalCount">0</span>
          </div>
          <div>√în h√¥m nay: <strong id="dueCount">0</strong></div>
          <div>Streak: <strong id="streakDays">0</strong> üî•</div>
        </section>

        <!-- Card v·ªõi hi·ªáu ·ª©ng l·∫≠t -->
        <section class="card" id="card">
          <div class="card-inner">
            <div class="card-front" id="cardFront">
              <div class="pos" id="pos"></div>
              <h2 class="word" id="word">word</h2>
              <div class="ipa" id="ipa">/ipa/</div>
              <!-- ·∫¢nh minh ho·∫° (th√™m referrerpolicy ƒë·ªÉ tr√°nh 403 t·ª´ Imgur) -->
              <img
                id="wordImg"
                alt=""
                referrerpolicy="no-referrer"
                style="
                  max-width: 100%;
                  height: auto;
                  border-radius: 12px;
                  margin: 8px 0;
                  display: none;
                "
              />

              <div class="actions">
                <button id="btn-speak" title="Nghe ph√°t √¢m">üîä Nghe</button>
                <button id="btn-show" class="secondary">L·∫≠t th·∫ª</button>
              </div>
            </div>

            <div class="card-back" id="cardBack">
              <h3 id="meaning">Nghƒ©a</h3>
              <p class="ex-en" id="exEn">Example sentence (EN).</p>
              <p class="ex-vi" id="exVi">C√¢u v√≠ d·ª• (VI).</p>
              <div class="srs-buttons">
                <button data-grade="again" class="danger">Again</button>
                <button data-grade="hard">Hard</button>
                <button data-grade="good" class="primary">Good</button>
                <button data-grade="easy" class="success">Easy</button>
              </div>
            </div>
          </div>
        </section>

        <section class="nav">
          <button id="prev">‚Üê Tr∆∞·ªõc</button>
          <button id="next">Sau ‚Üí</button>
          <button id="shuffle">X√°o tr·ªôn</button>
        </section>
      </main>
    </div>

    <!-- Modal Quiz -->
    <div id="quizModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Quiz(c√¢u h·ªèi)</h2>
          <button id="closeQuiz">‚úï</button>
        </div>
        <div id="quizRoot"></div>
      </div>
    </div>

    <!-- Modal Settings (TTS) -->
    <div id="settingsModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚öôÔ∏è C√†i ƒë·∫∑t gi·ªçng ƒë·ªçc</h2>
          <button id="closeSettings">‚úï</button>
        </div>
        <div class="modal-body">
          <label
            >Ch·ªçn gi·ªçng:
            <select id="voiceSelect"></select
          ></label>
          <br /><br />
          <label>
            T·ªëc ƒë·ªô:
            <input
              type="range"
              id="rateRange"
              min="0.5"
              max="1.5"
              step="0.05"
            />
            <span id="rateValue"></span>
          </label>
        </div>
      </div>
    </div>

    <!-- Modal Add/Edit Word -->
    <div id="addWordModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚ûï Th√™m / ‚úé S·ª≠a th·∫ª</h2>
          <button id="closeAddWord">‚úï</button>
        </div>

        <div class="modal-body" style="display: grid; gap: 10px">
          <label
            >L∆∞u v√†o ch·ªß ƒë·ªÅ:<br />
            <select
              id="addWordTopic"
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            ></select>
          </label>

          <label
            >Ti·∫øng Anh (b·∫Øt bu·ªôc):<br />
            <input
              id="addWordEn"
              type="text"
              placeholder="e.g., apple"
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </label>

          <label
            >Phi√™n √¢m /IPA/:<br />
            <input
              id="addWordIpa"
              type="text"
              placeholder="/Àà√¶p.…ôl/"
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </label>

          <label
            >T·ª´ lo·∫°i (pos):<br />
            <input
              id="addWordPos"
              type="text"
              placeholder="noun / verb / adj..."
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </label>

          <label
            >Nghƒ©a ti·∫øng Vi·ªát (b·∫Øt bu·ªôc):<br />
            <input
              id="addWordVi"
              type="text"
              placeholder="qu·∫£ t√°o"
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </label>

          <label
            >·∫¢nh minh ho·∫° (URL):<br />
            <input
              id="addWordImage"
              type="url"
              placeholder="https://..."
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            />
          </label>
          <!-- Th√™m referrerpolicy cho ·∫£nh preview -->
          <img
            id="addWordPreview"
            alt=""
            referrerpolicy="no-referrer"
            style="
              max-width: 100%;
              height: auto;
              border-radius: 10px;
              display: none;
            "
          />

          <label
            >V√≠ d·ª• (EN):<br />
            <textarea
              id="addWordExEn"
              rows="2"
              placeholder="An apple a day keeps the doctor away."
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            ></textarea>
          </label>

          <label
            >V√≠ d·ª• (VI):<br />
            <textarea
              id="addWordExVi"
              rows="2"
              placeholder="M·ªói ng√†y m·ªôt qu·∫£ t√°o gi√∫p b·∫°n kh·ªèe m·∫°nh."
              style="
                width: 100%;
                padding: 10px;
                border: 1px solid #ddd;
                border-radius: 8px;
              "
            ></textarea>
          </label>

          <div
            style="
              display: flex;
              gap: 8px;
              justify-content: space-between;
              flex-wrap: wrap;
              margin-top: 8px;
            "
          >
            <div style="display: flex; gap: 8px">
              <button id="clearImage" class="secondary">Xo√° ·∫£nh</button>
              <button id="deleteWordInModal" class="danger hidden">
                üóëÔ∏è Xo√° th·∫ª
              </button>
            </div>
            <div style="display: flex; gap: 8px">
              <button id="saveAddWord" class="primary">L∆∞u</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: Qu·∫£n l√Ω ch·ªß ƒë·ªÅ (m·ªõi) -->
    <div id="topicModal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Qu·∫£n l√Ω ch·ªß ƒë·ªÅ c·ªßa b·∫°n</h2>
          <button id="closeTopicModal">‚úï</button>
        </div>
        <div class="modal-body">
          <div style="display: grid; gap: 8px; margin-bottom: 16px">
            <label
              >T√™n ch·ªß ƒë·ªÅ:
              <input
                id="newTopicName"
                type="text"
                placeholder="V√≠ d·ª•: TOEIC, JLPT N5..."
              />
            </label>
            <label
              >Bi·ªÉu t∆∞·ª£ng (emoji tu·ª≥ ch·ªçn):
              <input id="newTopicIcon" type="text" placeholder="üìö" />
            </label>
            <button id="createTopic" class="primary">T·∫°o ch·ªß ƒë·ªÅ</button>
          </div>
          <hr />
          <h3>Ch·ªß ƒë·ªÅ c·ªßa t√¥i</h3>
          <div id="myTopics"></div>
          <p style="color: #666; margin-top: 10px">
            L∆∞u √Ω: Xo√° ch·ªß ƒë·ªÅ s·∫Ω xo√° lu√¥n c√°c th·∫ª v√† ti·∫øn tr√¨nh √¥n trong ch·ªß ƒë·ªÅ
            ƒë√≥.
          </p>
        </div>
      </div>
    </div>

    <!-- Data sets -->
    <script src="words_food.js"></script>
    <script src="words_family.js"></script>
    <script src="words_travel.js"></script>
    <script src="words_school.js"></script>
    <script src="words_work.js"></script>
    <script src="words_daily.js"></script>

    <!-- App logic -->
    <script src="quiz.js"></script>
    <script src="firebase.js"></script>
    <script src="app.js"></script>
  </body>
</html>
